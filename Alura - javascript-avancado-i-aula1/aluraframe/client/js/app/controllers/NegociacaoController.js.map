{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","constructor","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_ordemAtual","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_service","NegociacaoService","_init","lista","then","negociacoes","forEach","negociacao","adiciona","catch","erro","texto","setInterval","importaNegociacoes","data","DateHelper","textoParaDate","value","quantidade","valor","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","apaga","esvazia","ordena","coluna","inverteOrdem","a","b","importa","Negociacao","parseInt","parseFloat","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["\r\nclass NegociacaoController{\r\n\r\n    constructor(){\r\n        let $ = document.querySelector.bind(document);\r\n        this._inputData = $('#data');\r\n        this._inputQuantidade = $('#quantidade');\r\n        this._inputValor = $('#valor');\r\n        this._ordemAtual = '';\r\n\r\n        this._listaNegociacoes = new Bind(new ListaNegociacoes(),\r\n                                         new NegociacoesView($('#negociacoesView')),\r\n                                         'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\r\n\r\n        this._mensagem = new Bind(new Mensagem(),\r\n                                    new MensagemView($('.mensagemView')),\r\n                                    'texto');\r\n\r\n        this._service = new NegociacaoService();\r\n        \r\n        this._init();\r\n    }\r\n\r\n    _init() {\r\n\r\n        this._service\r\n            .lista()\r\n            .then( negociacoes =>\r\n                negociacoes.forEach(negociacao =>\r\n                    this._listaNegociacoes.adiciona(negociacao)))\r\n            .catch(erro => this._mensagem.texto = erro);\r\n\r\n        setInterval(() => {\r\n            this.importaNegociacoes();\r\n        }, 3000);\r\n    }\r\n\r\n    get data(){\r\n        return DateHelper.textoParaDate(this._inputData.value);\r\n    }\r\n\r\n    get quantidade(){\r\n        return this._inputQuantidade.value;\r\n    }\r\n\r\n    get valor(){\r\n        return this._inputValor.value;\r\n    }\r\n\r\n    adiciona(event){\r\n        event.preventDefault();\r\n\r\n        let negociacao = this._criaNegociacao();\r\n\r\n        this._service\r\n            .cadastra(negociacao)\r\n            .then(mensagem => {\r\n                this._listaNegociacoes.adiciona(negociacao);\r\n                this._mensagem.texto = mensagem;\r\n                this._limpaFormulario();\r\n            })\r\n            .catch (erro => this._mensagem.texto = erro);\r\n    }\r\n\r\n    apaga(){\r\n\r\n        this._service\r\n            .apaga()\r\n            .then(mensagem => {\r\n                this._listaNegociacoes.esvazia();\r\n                this._mensagem.texto = mensagem;\r\n                })\r\n            .catch (erro => this._mensagem.texto = erro);\r\n        \r\n    }\r\n\r\n    ordena(coluna) {\r\n        if(this._ordemAtual == coluna) {\r\n            this._listaNegociacoes.inverteOrdem();\r\n        } else {\r\n            this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);    \r\n        }\r\n        this._ordemAtual = coluna;\r\n    }\r\n\r\n    importaNegociacoes(){\r\n\r\n        this._service\r\n            .importa(this._listaNegociacoes.negociacoes)\r\n            .then(negociacoes => negociacoes.forEach(negociacao =>{\r\n                this._listaNegociacoes.adiciona(negociacao);\r\n                this._mensagem.texto = 'Negocições do períodp importadas';\r\n            }))\r\n            .catch(erro => this.mensagem.texto = erro);\r\n    }\r\n\r\n    _criaNegociacao(){\r\n\r\n        return new Negociacao(\r\n                this.data,\r\n                parseInt(this.quantidade),\r\n                parseFloat(this.valor),\r\n        );\r\n    }\r\n\r\n    _limpaFormulario(){\r\n\r\n        this._inputData.value = '';\r\n        this._inputQuantidade.value = 1;\r\n        this._inputValor.value = 0.0;\r\n\r\n        this._inputData.focus();\r\n    }\r\n}"]}